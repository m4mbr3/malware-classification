from sklearn.model_selection import train_test_split
from scipy import io
from matplotlib import pyplot
from sklearn.externals import joblib
from sklearn.metrics import accuracy_score
from sklearn.metrics import *
import pickle

matrix = io.mmread('matrix.mtx')
y = []
with open('list.mtx', 'r') as file_:
    for l in file_:
        y.append(int(l))

X_train, X_test, y_train, y_test = train_test_split (matrix, y, test_size=0.33, random_state=55)

clf = joblib.load('svm_model.pkl')

y_sample = [[1,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0],[0,0,0,1,0,0,0,0,0],[0,0,0,0,1,0,0,0,0],[0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,1]]

sum =[]

for i, row in enumerate(X_test):
    sum.append(coverage_error([y_sample[y_test[i]-1]], clf.predict_proba(row)))



pickle.dump(sum, open('sum.dump','w'))

y_pred = clf.predict(X_test)
